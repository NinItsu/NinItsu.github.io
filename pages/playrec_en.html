<html>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HDS3W3TLCY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HDS3W3TLCY');
</script>
<body bgcolor="#eafff0">
<br>
<h2>
<font face="Courier New"><b>Playrec Installation Notes (<a href=../playrec_jp.html target="_top">日本語バージョン</a>)</b></font>
</h2>
<hr>
<font face="Courier New">
<h3>Overview</h3>
This page introduces the latest installation method for <a href=https://www.playrec.co.uk/index.html>playrec</a>, a multi-channel audio input/output library for MATLAB.<br>
#As of July 16, 2025<br>
#Test environment: Windows 11, Intel 64-bit, MATLAB 2023a, Visual Studio 2019<br>
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;macOS 15.5, AppleSilicon 64-bit, MATLAB 2024a, Xcode 15<br>
#This page is translated by chatGPT.<br>

<h3>Background</h3>
Playrec development was discontinued around 2015, and since then, it has not been updated to support Win64 or recent changes in PortAudio/Windows SDK/macOS specifications.<br>
As a result, it is no longer possible to install it using only the official information, and even using online resources as a guide, installation is extremely difficult and time-consuming. Therefore, I have compiled the relevant information on this site.<br>
Currently, MATLAB's Audio Toolbox supports functions nearly equivalent to those of Playrec (via audioPlayerRecorder),
so if you are an academic or individual MATLAB user, I recommend using Audio Toolbox instead.<br>
However, since Audio Toolbox can be expensive for commercial licenses, we hope this site will be of help to those facing similar difficulties, as the author has.<br>

<h3>Installation Procedure (Common to All OS)</h3>
First, prepare by referring to the <a href=https://www.playrec.co.uk/compiling.html>latest official information</a> on Playrec.<br>
The latest files can be downloaded from <a href=https://github.com/PlayrecForMatlab/playrec>GitHub</a>.<br>
Regardless of your OS, you will also need to download the latest version of <a href="https://files.portaudio.com/download.html">PortAudio</a> (v19.7.0 stable release).<br>
<br>
Next, you will need to make some minor modifications to the '.m' scripts of Playrec.<br>
For 64-bit Windows support, refer to Professor Yoichi Haneda’s <a href=http://www.hanedalab.inf.uec.ac.jp/playrec_use.html>website</a>, 
and for adapting to changes in the PortAudio specifications, refer to the <a href=https://github.com/PlayrecForMatlab/playrec/pull/12/commits/f398b6b36b2f7e8afa831cf0b4e652589a385c3b>thread</a> by <i>alastairhmoore</i> on GitHub.<br>
<br>

<b>playrec-master/m_files/compile_playrec_func.m</b><br>
<pre>
    line 42-56: remove 'src/os/mac_osx'<br>
    <i>Original</i>
    <code>
        pa_include_dirs = {'src/common',...
                   'src/hostapi/alsa',...
                   'src/hostapi/asihpi',...
                   'src/hostapi/asio',...
                   'src/hostapi/coreaudio',...
                   'src/hostapi/dsound',...
                   'src/hostapi/jack',...
                   'src/hostapi/oss',...
                   'src/hostapi/wasapi',...
                   'src/hostapi/wdmks',...
                   'src/hostapi/wmme',...
                   <u>'src/os/mac_osx',...</u>
                   'src/os/unix',...
                   'src/os/win',...
                   'include'};      %just include all possibilities!
    </code>
    <i>Modified</i>
    <code>
        pa_include_dirs = {'src/common',...
                   'src/hostapi/alsa',...
                   'src/hostapi/asihpi',...
                   'src/hostapi/asio',...
                   'src/hostapi/coreaudio',...
                   'src/hostapi/dsound',...
                   'src/hostapi/jack',...
                   'src/hostapi/oss',...
                   'src/hostapi/wasapi',...
                   'src/hostapi/wdmks',...
                   'src/hostapi/wmme',...
                   'src/os/unix',...
                   'src/os/win',...
                   'include'};      %just include all possibilities!
    </code>
    line 78-80: revise 'src/os/mac_osx/pa_mac_hostapis.c' to 'src/os/unix/pa_unix_hostapis.c'<br>
    <i>Original</i>
    <code>
        pa_os_specific_files = [pa_os_specific_files, ...
                                <u>{'src/os/mac_osx/pa_mac_hostapis.c', ...</u>
                                'src/os/unix/pa_unix_util.c'}];
    </code>
    <i>Modified</i>
    <code>
        pa_os_specific_files = [pa_os_specific_files, ...
                                {'src/os/unix_osx/pa_unix_hostapis.c', ...
                                'src/os/unix/pa_unix_util.c'}];
    </code>
    (Optional, as ASIO for macOS has not been tested) line 84-93: modifications for ASIO support on macOS<br>
    <i>Original</i>
    <code>
        api_include_dirs = [api_include_dirs, ...
                            resolve_paths(asio_path,...
                                {'common',...
                                 'host',...
                                 <u>'host/mac'})];</u>
        api_files = [api_files,...
                     resolve_paths(asio_path,...
                         {'host/asiodrivers.cpp',...
                          <u>'host/mac/asioshlib.cpp',...</u>
                          <u>'host/mac/codefragements.cpp'})];</u>
    </code>
    <i>Modified</i>
    <code>
        api_include_dirs = [api_include_dirs, ...
                            resolve_paths(asio_path,...
                                {'common',...
                                 'host'})];</u>
        api_files = [api_files,...
                     resolve_paths(asio_path,...
                         {'host/asiodrivers.cpp'})];</u>
    </code>
    line 104: modifications for CoreAudio support on macOS<br>
    <i>Original</i>
    <code>
        <u>compiler_flags = [compiler_flags, {'PA_USE_COREAUDIO'}];</u>
    </code>
    <i>Modified</i>
    <code>
        compiler_flags = [compiler_flags, {'PA_USE_COREAUDIO=1',...
                                           '__MACOSX_CORE__'}];
    </code>
    line 114: modifications for WIN64<br>
    <i>Original</i>
    <code>
        <u>compiler_flags = [compiler_flags, {'WIN32'}];</u>
    </code>
    <i>Modified</i>
    <code>
        if strcmp(computer, 'PCWIN64')
            compiler_flags = [compiler_flags, {'WIN64'}];
        else %strcmp(computer, 'PCWIN32')
            compiler_flags = [compiler_flags, {'WIN32'}];
        end
    </code>
</pre>
<b>playrec-master/m_files/build_mex.m</b><br>
<pre>
    line 94: modifications for WIN64<br>
    <i>Original</i>
    <code>
        <u>build_args = {build_args{:}, ['LIB#', cell2mat(lib_dirs(n)), ';$LIB']};</u>
    </code>
    <i>Modified</i>
    <code>
        if strcmp(computer, 'PCWIN64')
            build_args = {build_args{:}, ['-L', cell2mat(lib_dirs(n))]};
        else %strcmp(computer, 'PCWIN32')
            build_args = {build_args{:}, ['LIB#', cell2mat(lib_dirs(n)), ';$LIB']};
        end
    </code>
</pre>
The other modifications described on Professor Haneda’s website have already been updated in the latest version on GitHub, so no further changes are necessary.<br>

<h3>Installation Procedure (Windows)</h3>
For Windows, you will need to download a C++ compiler (the author used Visual Studio 2019) and the <a href=https://developer.microsoft.com/ja-jp/windows/downloads/windows-sdk>Windows SDK</a> (the author used version 10.0.26100.0).<br>
If you plan to use ASIO, please prepare the <a href=https://www.steinberg.net/developers>ASIO SDK</a> in advance.<br>
DirectSound was supported in the past, but the author was unable to install it with the current SDK.<br>
<br>
Run 'playrec-master/compile_playrec.m' and follow the instructions — installation should be possible.<br>
#As mentioned earlier, please uncheck the DirectSound option.<br>
#If you place the PortAudio and ASIO folders into 'playrec-master/lib', the script will automatically detect their paths during execution.<br>
#The Platform SDK Directory should be 'C:\Program Files (x86)\Windows Kits\10'.<br>
#If 'playrec.mexw64' is generated in the folder, the installation is most likely successful.<br>

<h3>Installation Procedure (macOS)</h3>
Installation on macOS is quite challenging — the author felt discouraged many times — but if you are using only CoreAudio, it should be possible by following the steps below.<br>
<br>
As same as for Windows, run 'playrec-master/compile_playrec.m' and follow the on-screen instructions.<br>
#Uncheck the ASIO option, as enabling it will cause the script to use the C++ compiler (Xcode Clang++), which will fail to compile PortAudio.<br>
#Also uncheck Jack Audio Connection Kit, as it will result in a file-not-found error during the process.<br>
#Be sure to check both the Debug and Verbose options.<br>
<br>
During the process, an error will occur and compilation will stop, but if around ten '.o' files (e.g., 'mex_dll_core.o') have been generated in the folder, proceed to the next step.<br>
At this point, scroll back through the command window log. Copy the two lines right before the error message.<br>
The exact content may vary depending on your environment, but you will likely see something like the following in the log. ([USERNAME] represents your login username.)<br>
<pre>
    Command A
    <code>
        /Applications/MATLAB_R2024a.app/bin/maca64/usResourceCompiler3 --manifest-add 
        /private/var/folders/4t/wrqf688j0tldphxlqcl8nggc0000gn/T/mex_20302766153414_11620//mw_mex_tempmex_manifest.json 
        --bundle-name mexVersioning --out-file 
        /private/var/folders/4t/wrqf688j0tldphxlqcl8nggc0000gn/T/mex_20302766153414_11620//mw_mex_tempmex_bundle.zip
    </code>
    Command B
    <code>
        /usr/bin/xcrun -sdk macosx15.5 clang -Wl,-twolevel_namespace  -arch arm64 -mmacosx-version-min=11.0 -Wl,
        -syslibroot,/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX15.5.sdk 
        -bundle  -Wl,-exported_symbols_list,"/Applications/MATLAB_R2024a.app/extern/lib/maca64/mexFunction.map" 
        mex_dll_core.o pa_dll_playrec.o pa_allocation.o pa_converters.o pa_cpuload.o pa_debugprint.o pa_dither.o 
        pa_front.o pa_process.o pa_ringbuffer.o pa_hostapi_skeleton.o pa_stream.o pa_trace.o pa_mac_core.o pa_mac_core_utilities.o 
        pa_mac_core_blocking.o pa_unix_hostapis.o pa_unix_util.o c_mexapi_version.o  -g -Wl,-exported_symbols_list,
        "/Applications/MATLAB_R2024a.app/extern/lib/maca64/c_exportsmexfileversion.map"  -L"/Applications/MATLAB_R2024a.app/bin/maca64" 
        -lmx -lmex -lmat -lc++ -o /Users/[USERNAME]/Documents/MATLAB/playrec-master/playrec.mexmaca64 -Wl,
        -sectcreate,__TEXT,us_resources,/private/var/folders/4t/wrqf688j0tldphxlqcl8nggc0000gn/T/mex_20282859537241_11620//mw_mex_tempmex_bundle.zip 
    </code>
</pre>
Paste these commands into a text editor for editing.<br>
<br>
First, in Command B, add the following content just before 'mex_dll_core.o' on line 3 (there is only one line in the command window through).<br>
<pre>
    <code>
        -framework CoreAudio -framework AudioToolbox -framework AudioUnit -framework CoreFoundation -framework CoreServices
    </code>
</pre>
Next, modify the '/private/var/...'' path found on line 2 and line 4 of Command A, as well as at the end of Command B, to a suitable folder that you have access to. For example: <br>
<pre>
    <code>
        /Users/[USERNAME]/Downloads/mw_mex_tempmex_manifest.json 
    </code>
    <code>
        /Users/[USERNAME]/Downloads/mw_mex_tempmex_bundle.zip 
    </code>
</pre>
#This '.zip' file will be temporarily generated. Please delete it manually after the installation is complete.<br>
After editing, the commands should look like this:<br>
<pre>
    Command A
    <code>
        /Applications/MATLAB_R2024a.app/bin/maca64/usResourceCompiler3 --manifest-add 
        /Users/[USERNAME]/Downloads/mw_mex_tempmex_manifest.json  
        --bundle-name mexVersioning --out-file 
        /Users/[USERNAME]/Downloads/mw_mex_tempmex_bundle.zip 
    </code>
    Command B
    <code>
        /usr/bin/xcrun -sdk macosx15.5 clang -Wl,-twolevel_namespace  -arch arm64 -mmacosx-version-min=11.0 -Wl,
        -syslibroot,/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX15.5.sdk 
        -bundle  -Wl,-exported_symbols_list,"/Applications/MATLAB_R2024a.app/extern/lib/maca64/mexFunction.map" 
        -framework CoreAudio -framework AudioToolbox -framework AudioUnit -framework CoreFoundation -framework CoreServices 
        mex_dll_core.o pa_dll_playrec.o pa_allocation.o pa_converters.o pa_cpuload.o pa_debugprint.o pa_dither.o 
        pa_front.o pa_process.o pa_ringbuffer.o pa_hostapi_skeleton.o pa_stream.o pa_trace.o pa_mac_core.o pa_mac_core_utilities.o 
        pa_mac_core_blocking.o pa_unix_hostapis.o pa_unix_util.o c_mexapi_version.o  -g -Wl,-exported_symbols_list,
        "/Applications/MATLAB_R2024a.app/extern/lib/maca64/c_exportsmexfileversion.map"  -L"/Applications/MATLAB_R2024a.app/bin/maca64" 
        -lmx -lmex -lmat -lc++ -o /Users/[USERNAME]/Documents/MATLAB/playrec2025/playrec.mexmaca64 -Wl,
        -sectcreate,__TEXT,us_resources,/Users/[USERNAME]/Downloads/mw_mex_tempmex_bundle.zip
    </code>
</pre>
Open terminal in mac, and navigate to the folder where the '.o' files were generated.<br>
<pre>
    <code>
        cd /Users/[USERNAME]/Documents/MATLAB/playrec-master
    </code>
</pre>
Run the edited Command A in the terminal. An error will appear, just ignore it.<br>
At this point, the 'mw_mex_tempemx_bundle.zip' file should have been generated.<br>
Then, run Command B in the terminal.<br>
Once completed, if 'playrec.mexmaca64' has been created in the folder containing the '.o' files, the installation is complete.<br>
#You can safely delete the '.o' files after the process is finished.<br>
</font>
</body>
</html>